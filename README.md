# Processing platform

Платформа выполняет обработку изображений и поиск информации на них. Пользуясь API системы, можно выполнить поиск изображений, удовлетворяющих указанным параметрам, или получить полные результаты анализа для конкретного изображения.

Система анализирует получаемые изображения и сохраняет результаты для дальнейшего поиска или использования. Вся обработка и анализ изображений выполняются асинхронно, а обработчики могут работать независимо друг от друга или совместно. Это позволяет реализовывать практически любые варианты обработки данных, начиная от простейшего поиска объектов на изображениях и заканчивая сложными схемами улучшения изображений.

В публичном доступе сейчас есть базовые обработчики изображений, выполняющие разметку лиц и номерных знаков автомобилей. Этого достаточно чтобы получить представление о принципах работы системы.

Адрес сервера: `http://45.135.265.211:9991`

## API

Система предоставляет REST интерфейс для загрузки изображений и поиска объектов на этих изображениях.

### Загрузка изображений

POST `/v1/processor/sink` 

Параметры:

Name | Type | Description
:---------------: | :---------------: | ---------------
data | MultipartFile | Изображение для выполнения анализа.
processors | String | Перечисление процессоров для выполнения обработок. Процессоры должны быть разделены ",". Возможны следующие значения: `fast-faces-detector`, `fast-plates-detector`.

В ответе будет возвращен уникальный ID объекта и перечислены вызываемые обработчики.

### Получение загруженного изображения

Можно получить исходное изображение по его ID.

GET `/v1/processor/sink/{id}`

Параметры:

Name | Type | Description
:---------------: | :---------------: | :---------------:
id | String | Идентификатор объекта.

### Поиск изображений с объектами

Выполняет поиск изображений, содержащих объекты c указанными параметрами.

POST `/v1/search/objects`

Параметры:

Name | Type | Description
:---------------: | :---------------: | :---------------:
label | String | Метка объекта на изображении. Возможны следующие значения: `face`, `plate`.

В ответе придет список объектов, удовлетворяющих параметрам запроса.

Пример ответа:

```json
[
  {
    "imageId": "ed4bcf88-f321-3757-ac22-362b967081a8",
    "label": "face",
    "geometry": "{335, 896, 164x164}",
    "timestamp": "2022-10-01T21:53:03.302+00:00"
  }
]
```

Поля:

Name | Type | Description
:---------------: | :---------------: | ---------------
imageId | String | Идентификатор изображения.
label | String | Метка объекта.
geometry | String | Геометрия области в формате { TOP, LEFT, WIDTHxHEIGHT }.
timestamp | Timestamp with timezone | Время создания.
### Обнаруженные объекты

Можно получить список объектов для конкретного изображения по его ID.

GET `/v1/search/objects/{id}`

Параметры:

Name | Type | Description
:---------------: | :---------------: | :---------------:
id | String | Идентификатор объекта.

Ответ будет содержать список локализованных объектов. 

Пример ответа:

```json
[
  {
    "imageId": "ed4bcf88-f321-3757-ac22-362b967081a8",
    "label": "face",
    "geometry": "{335, 896, 164x164}",
    "timestamp": "2022-10-01T21:53:03.302+00:00"
  },
  {
    "imageId": "ed4bcf88-f321-3757-ac22-362b967081a8",
    "label": "plate",
    "geometry": "{232, 301, 264x216}",
    "timestamp": "2022-10-01T21:53:03.809+00:00"
  }
]
```

### Отрисовка объектов

Можно выполнить примитивную отрисовку обнаруженных объектов. Будет возвращено изображение с отрисованными рамками вокруг обнаруженных объектов.

POST `/v1/search/display`

Параметры:

Name | Type | Description
:---------------: | :---------------: | ---------------
label | String | Метка объекта на изображении. Возможны следующие значения: `face`, `plate`.
id | String | Идентификатор объекта.


## Ограничения

В настоящее время есть следующие ограничения:
- максимальный размер изображения 5 МБ;
- доступны базовые обработчики;
- ограничены вычислительные ресурсы;
- данные хранятся не более 1 часа.
